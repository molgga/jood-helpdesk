import{d as w,am as g,o as p,c as m,m as n,I as v,Y as k,w as x,F as E,D as L,E as f,a as _,t as I,_ as A}from"./chunks/framework.WU9gZgzV.js";var y=(r=>(r[r.IGNORE=0]="IGNORE",r[r.UPDATE=1]="UPDATE",r))(y||{});class K{constructor(t){this.dataExpire=0,this.storage=t}get key(){if(!this.archiveKey)throw new Error(`not allow key = "${this.archiveKey}"`);return this.archiveKey}init(t){const{key:e="",max:s=0,dataExpire:a=0,existProcessType:o=y.IGNORE,findExist:i}=t;if(!e)throw new Error(`not allow key = "${e}"`);this.archiveKey=e,this.archiveMax=s,this.dataExpire=a,this.existProcessType=o,this.findExist=i}getList(){const t=JSON.parse(this.storage.getItem(this.archiveKey)||"[]"),e=this.nowTime(),s=[];return t.forEach(a=>{const{expireAt:o=0,data:i}=a;i!=null&&e<o&&s.push(a)}),s}push(t){const e=this.insert("push",t),s=0<this.archiveMax&&this.archiveMax<e.length?e.slice(e.length-this.archiveMax):e;this.storage.setItem(this.key,JSON.stringify(s))}unshift(t){const e=this.insert("unshift",t),s=0<this.archiveMax?e.slice(0,this.archiveMax):e;this.storage.setItem(this.key,JSON.stringify(s))}insert(t,e){const s=this.getList(),a=this.nowExpireAt(),o=this.findExist?this.findExist(e,s):-1;if(o===-1)s[t]({expireAt:a,data:e});else if(this.existProcessType===y.UPDATE){const i=s.splice(o,1)[0];s[t]({...i,data:{...i.data,...e},expireAt:a})}return s}removeByIndex(t){if(t===null||isNaN(t)||t<0)return;const e=this.getList();e.splice(Math.max(0,Math.min(e.length-1,t)),1),this.storage.setItem(this.key,JSON.stringify(e))}clear(){this.storage.removeItem(this.key)}clearByExpired(){const t=this.getList();t.length?this.storage.setItem(this.key,JSON.stringify(t)):this.storage.removeItem(this.key)}nowTime(){return Date.now()}nowExpireAt(){return this.nowTime()+this.dataExpire}}const N={class:"actions"},O={class:"add-keyword"},M={class:"keyword-list"},S={class:"keyword-item"},B=["onClick"],D=w({__name:"ExampleArchiveList",setup(r){const t=g({addKeyword:"",list:[]}),e=new K(window.localStorage);e.init({key:"my-storage-key",dataExpire:1e3*60*3,max:3,existProcessType:y.UPDATE,findExist:(d,c)=>c.findIndex(h=>d.keyword===h.data.keyword)});const s=()=>{t.addKeyword&&(e.unshift({keyword:t.addKeyword}),i(),t.addKeyword="")},a=()=>{e.clearByExpired(),i()},o=d=>{const c=e.getList().findIndex(h=>{var l;return((l=h.data)==null?void 0:l.keyword)===d});-1<c&&e.removeByIndex(c),i()},i=()=>{t.list=e.getList().map(d=>d.data)};return a(),(d,c)=>{const h=f("el-input"),l=f("el-button");return p(),m("div",null,[n("div",N,[n("div",O,[v(h,{modelValue:t.addKeyword,"onUpdate:modelValue":c[0]||(c[0]=u=>t.addKeyword=u),placeholder:"keyword",onKeyup:k(s,["enter"])},null,8,["modelValue"]),v(l,{class:"action",onClick:s},{default:x(()=>[_("add")]),_:1})]),v(l,{class:"action",onClick:a},{default:x(()=>[_("update expired")]),_:1})]),n("div",M,[(p(!0),m(E,null,L(t.list,u=>(p(),m("div",S,[n("div",null,I(u.keyword),1),n("button",{class:"remove",onClick:J=>o(u.keyword)},"X",8,B)]))),256))])])}}}),P=A(D,[["__scopeId","data-v-8be6fc38"]]),T=n("h1",{id:"archivelist",tabindex:"-1"},[_("ArchiveList "),n("a",{class:"header-anchor",href:"#archivelist","aria-label":'Permalink to "ArchiveList"'},"​")],-1),b=n("p",null,"로컬 보관소(로컬 스토리지) 데이터 저장과 expire 지원. 배열형.",-1),$=JSON.parse('{"title":"ArchiveList","description":"","frontmatter":{},"headers":[],"relativePath":"module/storage-archive/ArchiveList.md","filePath":"module/storage-archive/ArchiveList.md"}'),C={name:"module/storage-archive/ArchiveList.md"},U=Object.assign(C,{setup(r){return(t,e)=>(p(),m("div",null,[T,b,v(P)]))}});export{$ as __pageData,U as default};
