import{k as A,S as T}from"./chunks/Subject.S6NvqjeN.js";import{d as C,am as B,k as b,l as _,A as S,_ as f,o as d,c as g,m as h,t as r,q as v,s as x,I as w,U as c}from"./chunks/framework.WU9gZgzV.js";const M=(a,s=540)=>{const i=new Date(a),n=(i.getTimezoneOffset()+s)*60*1e3;return new Date(i.getTime()+n)};class o{constructor(s={}){this.fallbackLoose=!0,this.fallbackLooseTimeout=1e3,this.timer=null,this.timerLoose=null,this.timezoneOffset=540,this.startAt=0,this.executeAt=0,this.executedAt=0,this.executeGap=0,this.executeSafeGap=10,this.isDestroy=!1;const{fallbackLoose:i=!0,fallbackLooseTimeout:n,timezoneOffset:t}=s;this.fallbackLoose=i,n&&(this.fallbackLooseTimeout=n),t&&(this.timezoneOffset=t),this.subject=new A,this.observable=this.subject.asObservable()}nowDate(){return M(Date.now(),this.timezoneOffset)}nowAt(){return this.nowDate().getTime()}getStartAt(){return this.startAt}getExecuteGap(){return this.executeGap}setExecuteSafeGap(s){this.executeSafeGap=s}executeTimout(){clearTimeout(this.timer);const s=this.nowDate(),i=this.getNextGap(s)+this.executeSafeGap;this.executeAt=s.getTime(),this.executeGap=this.executeAt-this.startAt,this.timer=setTimeout(()=>{this.dispatch(),this.executeTimout()},i),this.fallbackLoose&&(this.timerLoose=setTimeout(()=>{this.dispatch()},i+this.fallbackLooseTimeout))}getNextGap(s){return 1e3-s.getMilliseconds()}isTargetChanged(){return!1}dispatch(){this.isDestroy||this.isTargetChanged()&&(this.executedAt=this.nowDate().getTime(),this.executeGap=this.executedAt-this.startAt,this.subject.next())}observe(){return this.observable}start(){this.startAt=this.nowAt(),this.executeTimout()}stop(){clearTimeout(this.timer),clearTimeout(this.timerLoose)}destroy(){this.stop(),this.isDestroy=!0,this.subject.unsubscribe()}}class G extends o{constructor(){super(...arguments),this.fallbackLooseTimeout=1e3}getNextGap(s){return 6e4-(s.getSeconds()*1e3+s.getMilliseconds())}isTargetChanged(){return new Date(this.executeAt).getMinutes()!==new Date(this.nowAt()).getMinutes()}}class L extends o{constructor(){super(...arguments),this.fallbackLooseTimeout=200}getNextGap(s){return 1e3-s.getMilliseconds()}isTargetChanged(){return new Date(this.executeAt).getSeconds()!==new Date(this.nowAt()).getSeconds()}}const q=C({setup(){const a=Date.now(),s=new L,i=new G,n=new T,t=B({secondDate:null,minuteDate:null}),k=b(()=>{const{secondDate:e,minuteDate:l}=t,m=(e==null?void 0:e.toLocaleString())||"",D=(l==null?void 0:l.toLocaleString())||"";return{labelSecondTimer:m,labelMinuteTimer:D}}),F=()=>{p()},u=()=>{E()},p=()=>{const e=a+s.getExecuteGap();t.secondDate=new Date(e)},E=()=>{const e=a+i.getExecuteGap();t.minuteDate=new Date(e)};return _(()=>{n.add(s.observe().subscribe(F)),s.start(),n.add(i.observe().subscribe(u)),i.start(),p(),E()}),S(()=>{s.stop(),i.stop(),n.unsubscribe()}),{state:t,viewState:k}}}),y=a=>(v("data-v-cce4cdf1"),a=a(),x(),a),I={class:"times"},U={class:"time"},N=y(()=>h("dt",null,"SecondTimer",-1)),O={class:"time"},P=y(()=>h("dt",null,"MinuteTimer",-1));function j(a,s,i,n,t,k){return d(),g("div",null,[h("div",I,[h("dl",U,[N,h("dd",null,r(a.viewState.labelSecondTimer),1)]),h("dl",O,[P,h("dd",null,r(a.viewState.labelMinuteTimer),1)])])])}const z=f(q,[["render",j],["__scopeId","data-v-cce4cdf1"]]),V=c("",4),$=c("",6),Z=JSON.parse('{"title":"Timer","description":"","frontmatter":{},"headers":[],"relativePath":"module/timer/Timer__advance.md","filePath":"module/timer/Timer__advance.md"}'),R={name:"module/timer/Timer__advance.md"},H=Object.assign(R,{setup(a){return(s,i)=>(d(),g("div",null,[V,w(z),$]))}});export{Z as __pageData,H as default};
